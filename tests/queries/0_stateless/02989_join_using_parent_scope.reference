-- { echoOn }
SELECT 1 AS a FROM tb JOIN tabc USING (a) ORDER BY *;
1
1
1
1
SELECT a + 2 AS b FROM ta JOIN tabc USING (b) ORDER BY *;
2
3
4
SELECT b + 2 AS a FROM tb JOIN tabc USING (a) ORDER BY *;
2
3
SELECT a + 2 AS c FROM ta JOIN tabc USING (c) ORDER BY *;
2
3
4
5
SELECT b AS a, a FROM tb JOIN tabc USING (a) ORDER BY *;
0	0
1	1
2	2
3	3
SELECT 1 AS b FROM tb JOIN ta USING (b); -- { serverError UNKNOWN_IDENTIFIER }
-- SELECT * works returns all columns from both tables in new analyzer
SET allow_experimental_analyzer = 1;
SELECT 3 AS a, a, * FROM tb FULL JOIN tabc USING (a) ORDER BY *;
3	3	0	3
3	3	1	3
3	3	2	3
3	3	3	3
3	3	\N	0
3	3	\N	1
3	3	\N	2
SELECT b + 1 AS a, * FROM tb JOIN tabc USING (a) ORDER BY *;
1	0	1
2	1	2
3	2	3
SELECT b + 1 AS a, * FROM tb JOIN tabc USING (a) ORDER BY *;
1	0	1
2	1	2
3	2	3
SELECT b + 1 AS a, * FROM tb LEFT JOIN tabc USING (a) ORDER BY *;
1	0	1
2	1	2
3	2	3
4	3	\N
SELECT b + 1 AS a, * FROM tb RIGHT JOIN tabc USING (a) ORDER BY *;
1	0	1
2	1	2
3	2	3
\N	\N	0
SELECT b + 1 AS a, * FROM tb FULL JOIN tabc USING (a) ORDER BY *;
1	0	1
2	1	2
3	2	3
4	3	\N
\N	\N	0
SELECT b + 1 AS a, * FROM tb FULL JOIN tabc USING (a) ORDER BY * SETTINGS asterisk_include_alias_columns = 1;
1	0	1	2	3
2	1	2	3	4
3	2	3	4	5
4	3	\N	\N	\N
\N	\N	0	1	2
SELECT b + 1 AS a, * FROM (SELECT b FROM tb) t1 JOIN (SELECT a, b FROM tabc) t2 USING (a) ORDER BY *;
1	0	1	2
2	1	2	3
3	2	3	4
SELECT b + 1 AS a, * FROM (SELECT b FROM tb) t1 LEFT JOIN (SELECT a, b FROM tabc) t2 USING (a) ORDER BY *;
1	0	1	2
2	1	2	3
3	2	3	4
4	3	\N	\N
SELECT b + 1 AS a, * FROM (SELECT b FROM tb) t1 RIGHT JOIN (SELECT a, b FROM tabc) t2 USING (a) ORDER BY *;
1	0	1	2
2	1	2	3
3	2	3	4
\N	\N	0	1
SELECT b + 1 AS a, * FROM (SELECT b FROM tb) t1 FULL JOIN (SELECT a, b FROM tabc) t2 USING (a) ORDER BY *;
1	0	1	2
2	1	2	3
3	2	3	4
4	3	\N	\N
\N	\N	0	1
DROP TABLE IF EXISTS tabc;
DROP TABLE IF EXISTS ta;
DROP TABLE IF EXISTS tb;
DROP TABLE IF EXISTS tc;
